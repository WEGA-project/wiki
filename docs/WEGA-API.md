
### Настройка WEGA-API
<code>WEGA-API</code> - отвечает за получение данных от контроллеров сбора показаний сенсоров. Контроллеры подключаются к ней и передают измеренные значения.

Каждому контроллеру соответствует свой файл api в котором указана база для записи данных и параметры подключения к ней.

#### Настраиваем подключение к базе данных для WEGA-API
Отредактируем файл примера:

указываем параметры подключения к базе для записи данных.

Создадим файл доступа к wega-api из файла примера:
 cp /var/WEGA/example/wega-api/wegabox.php.example /var/WEGA/wega-api/wegabox.php
 nano /var/WEGA/wega-api/wegabox.php
Тут главная задача, отредактировать строку, поменяв ключ доступа на свой. Этот ключи будет использовать устройство при отправке данных на сервер. $auth="73ad7a1144dfc58eb2585cde8a0f7a948338";

## **ВАЖНО: Один ключ = один api. Много устройств могут использовать один api, но можно создавать много api для разных устройств. **
### Проверка API post
Выполним в браузере:

<code><nowiki>http://WEGA_SERVER_IP/wega-api/wegabox.php?auth=adab637320e5c47624cdd15169276981&db=esp32wega&RootTemp=25&AirTemp=25&AirHum=50</nowiki></code>

где

* <code>ip-address-server</code> это адрес сервера
* <code>auth=adab637320e5c47624cdd15169276981</code> код доступа к <code>api</code> (должен быть задан в файле <code>/var/WEGA/wega-api/wegabox.php</code>)
* <code>db=esp32wega</code> имя в базы данных для записи(для каждого модуля <code>ESP</code> должна быть своя база данных)

Это действие создаст базу даных с таблицей <code>sens</code> и внесет тестовый набор сеносоров как будто все они показывают значение единица.

Войдем в интерфейс <code>WEGA</code> <code><nowiki>http://ip-address-server/wega</nowiki></code> выбираем <code>анализ -> таблица значений</code>.

Мы должны увидить запись с меткой времени и единицами в полях значений.

Параметры обработки сенсоров расположены в каталоге:
 #имя вашего конфиг файла и именем базы данных для вашей гидропонной системы
 cd /var/WEGA/wegagui/config
 cp example/example.conf.php esp32wega.conf.php 
 nano esp32wega.conf.php 
Если у вас больше чем один модуль <code>WEGA-ESP32</code>, то вам не обходимо создать новый конфиг файл и так для каждого модуля <code>WEGA-ESP32</code>

Ниже можно видеть как создать еще один конфиг файл для второго модуля <code>WEGA-ESP32</code>
 #имя вашего конфиг файла и именем базы данных для вашей гидропонной системы
 cd /var/WEGA/wegagui/config
 cp example/example.conf.php mainNFT.conf.php 
 nano mainNFT.conf.php